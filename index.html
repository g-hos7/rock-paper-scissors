<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>
            Rock Paper Scissors
        </title>
        <meta name="author" content="Tim Barnes">
        <meta name="description" content="Play Rock Paper Scissors in your browser"> 
    </head>

    <body>
        <script>
            function getRandomNum() {
                return Math.floor(Math.random() * (3 - 1 +1)) + 1;
            }

            // Use a random number between 1 and 3 to determine a random move
            function getComputerSelection() {
                let randomMove = getRandomNum();
                if (randomMove === 1) {
                    randomMove = "rock";
                } else if (randomMove === 2) {
                    randomMove = "paper";
                } else {
                    randomMove = "scissors";
                }
                return randomMove;
            }

            // Get input from the user
            function getPlayerSelection() {
                let playerMove = prompt("Choose rock, paper or scissors").toLowerCase();
                return playerMove;
            }

            // Determine who won a single round
            function getRoundResult(playerSelection, computerSelection) {
                let roundResult = ""

                if (playerSelection === computerSelection) {
                    roundResult = "tie";
                } else if (playerSelection === "rock") {
                    if (computerSelection === "paper") {
                        roundResult = "loss";
                    } else if (computerSelection === "scissors") {
                        roundResult = "win";
                    }
                } else if (playerSelection === "paper") {
                    if (computerSelection === "rock") {
                        roundResult = "win";
                    } else if (computerSelection === "scissors") {
                        roundResult = "loss";
                    }
                } else if (playerSelection === "scissors") {
                    if (computerSelection === "rock") {
                        roundResult = "loss";
                    } else if (computerSelection === "paper") {
                        roundResult = "win";
                    }
                }
                return roundResult;
            }

            // Simple helper functions to print messages
            function showRoundWin(playerMove, computerMove) {
                console.log(`You win this round! ${playerMove} beats ${computerMove}`);
            }

            function showRoundLoss(playerMove, computerMove) {
                console.log(`You lose this round! ${computerMove} beats ${playerMove}`);
            }

            function showRoundTie(playerMove) {
                console.log(`It's a tie! You both choose ${playerMove}`);
            }

            function showInvalidMessage() {
                console.log("Please choose rock, paper or scissors");
            }

            function showGameTie(playerScore, computerScore) {
                console.log(`You tied with the computer! You: ${playerScore} | Computer: ${computerScore}`);
            }

            function showGameWin(playerScore, computerScore) {
                console.log(`You won the most rounds! You: ${playerScore} | Computer: ${computerScore}`);
            }

            function showGameLoss(playerScore, computerScore) {
                console.log(`You lost the most rounds! You: ${playerScore} | Computer: ${computerScore}`);
            }
            
            // Determine which round result message to disply
            function checkRoundWinner(playerSelection, computerSelection, roundResult) {
                let winner = "";
                if (roundResult === "win") {
                        showRoundWin(playerSelection, computerSelection);
                        winner = "player";
                    } else if (roundResult === "loss") {
                        showRoundLoss(playerSelection, computerSelection);
                        winner = "computer";
                    } else if (roundResult === "tie") {
                        showRoundTie(playerSelection);
                        winner = "tie";
                    } else {
                        showInvalidMessage();
                    }
                    return winner;
            }

            // Determine who had the most wins overall
            function checkOverallWinner(playerScore, computerScore) {
                if (playerScore === computerScore) {
                    showGameTie(playerScore, computerScore);
                } else if (playerScore > computerScore) {
                    showGameWin(playerScore, computerScore);
                } else {
                    showGameLoss(playerScore, computerScore);
                }
            }

            // Play a set number of rounds and track wins for each player
            function playGame() {
                let playerScore = 0;
                let computerScore = 0;

                for (let i = 0; i < 5; i++) {
                    let playerSelection = getPlayerSelection();
                    let computerSelection = getComputerSelection();
                    let roundResult = getRoundResult(playerSelection, computerSelection);
                    let roundWinner = checkRoundWinner(playerSelection, computerSelection, roundResult);
                    
                    if (roundWinner === "player") {
                        playerScore++;
                    } else if (roundWinner === "computer") {
                        computerScore++;
                    } else if (roundWinner === "tie") {
                        //tie round, no one scores
                        continue;
                    } else {
                        //invalid user input, repeat the same round until we get valid input
                        i--;
                    }
                }
                checkOverallWinner(playerScore, computerScore);
            }

            playGame();
            
        </script>

    </body>
</html>